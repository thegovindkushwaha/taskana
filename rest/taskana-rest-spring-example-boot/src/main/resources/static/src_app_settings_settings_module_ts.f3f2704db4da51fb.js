"use strict";(self.webpackChunktaskana_web=self.webpackChunktaskana_web||[]).push([["src_app_settings_settings_module_ts"],{6517:(q,_,r)=>{r.r(_),r.d(_,{SettingsModule:()=>Y});var p=r(6362),u=r(9720),M=r(253),T=r(3336),l=(()=>{return(n=l||(l={})).Text="text",n.Interval="interval",n.Color="color",n.Json="json",l;var n})(),f=r(558),b=r(4118),S=r(2685),Z=r(8139),O=r(8951),t=r(3184),A=r(7312),v=r(7317),h=r(9715),x=r(5590),y=r(4770),C=r(3365),c=r(587),J=r(1307);function P(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",12)(1,"div",13),t._uU(2),t.qZA(),t.TgZ(3,"mat-form-field",14)(4,"mat-label"),t._uU(5),t.qZA(),t.TgZ(6,"input",15),t.NdJ("ngModelChange",function(a){t.CHM(e);const s=t.oxw().$implicit;return t.oxw(2).settings[s.key]=a}),t.qZA()()()}if(2&n){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(2),t.hij(" ",e.displayName," "),t.xp6(2),t.Tol(e.key),t.xp6(1),t.Oqu(e.displayName),t.xp6(1),t.s9C("maxlength",e.max),t.s9C("minlength",e.min),t.s9C("placeholder",e.displayName),t.Q6J("ngModel",i.settings[e.key])}}function U(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",12)(1,"div",13),t._uU(2),t.qZA(),t.TgZ(3,"mat-form-field",16)(4,"mat-label"),t._uU(5,"Lower boundary"),t.qZA(),t.TgZ(6,"input",17),t.NdJ("ngModelChange",function(a){t.CHM(e);const s=t.oxw().$implicit;return t.oxw(2).settings[s.key][0]=a}),t.qZA()(),t.TgZ(7,"mat-form-field",16)(8,"mat-label"),t._uU(9,"Upper boundary"),t.qZA(),t.TgZ(10,"input",18),t.NdJ("ngModelChange",function(a){t.CHM(e);const s=t.oxw().$implicit;return t.oxw(2).settings[s.key][1]=a}),t.qZA()()()}if(2&n){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(e.displayName),t.xp6(2),t.Tol(e.key),t.xp6(2),t.s9C("max",e.max),t.s9C("min",e.min),t.Q6J("ngModel",i.settings[e.key][0]),t.xp6(2),t.Tol(e),t.xp6(2),t.s9C("max",e.max),t.s9C("min",e.min),t.Q6J("ngModel",i.settings[e.key][1])}}function $(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",19)(1,"div",13),t._uU(2),t.qZA(),t.TgZ(3,"input",20),t.NdJ("change",function(){t.CHM(e);const a=t.oxw().$implicit;return t.oxw(2).onColorChange(a.key)}),t.qZA()()}if(2&n){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(e.displayName),t.xp6(1),t.s9C("id",e.key),t.s9C("value",i.settings[e.key])}}function R(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",12)(1,"div",13),t._uU(2),t.qZA(),t.TgZ(3,"mat-form-field",14)(4,"mat-label"),t._uU(5),t.qZA(),t.TgZ(6,"textarea",21),t.NdJ("ngModelChange",function(a){t.CHM(e);const s=t.oxw().$implicit;return t.oxw(2).settings[s.key]=a}),t.qZA()()()}if(2&n){const e=t.oxw().$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(e.displayName),t.xp6(2),t.Tol(e.key),t.xp6(1),t.hij(" ",e.displayName," "),t.xp6(1),t.s9C("placeholder",e.displayName),t.Q6J("ngModel",i.settings[e.key])}}function k(n,o){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,P,7,9,"div",10),t.YNc(2,U,11,13,"div",10),t.YNc(3,$,4,3,"div",11),t.YNc(4,R,7,7,"div",10),t.qZA()),2&n){const e=o.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.type==i.settingTypes.Text),t.xp6(1),t.Q6J("ngIf",e.type==i.settingTypes.Interval),t.xp6(1),t.Q6J("ngIf",e.type==i.settingTypes.Color),t.xp6(1),t.Q6J("ngIf",e.type==i.settingTypes.Json)}}function E(n,o){if(1&n&&(t.TgZ(0,"div")(1,"h4",8),t._uU(2),t.qZA(),t.YNc(3,k,5,4,"div",7),t._UZ(4,"div",9),t.qZA()),2&n){const e=o.$implicit;t.xp6(2),t.hij(" ",e.displayName," "),t.xp6(1),t.Q6J("ngForOf",e.members)}}class m{constructor(o,e,i){this.store=o,this.notificationService=e,this.requestInProgressService=i,this.settingTypes=l,this.invalidMembers=[],this.destroy$=new M.x}ngOnInit(){this.settings$.pipe((0,O.R)(this.destroy$)).subscribe(o=>{this.requestInProgressService.setRequestInProgress(!1),this.settings=this.deepCopy(o),this.oldSettings=this.deepCopy(o)})}deepCopy(o){return JSON.parse(JSON.stringify(o))}onSave(){this.changeLabelColor("grey"),this.invalidMembers=(n=>{const o=[];for(let e of n.schema)for(let i of e.members){const a=n[i.key];if(i.type==l.Text||i.type==l.Interval){let s,g;switch(i.type){case l.Text:s=a.length,g=a.length;break;case l.Interval:s=a[0],g=a[1]}let d=!0;(i.min||0==i.min)&&i.max?d=s>=i.min&&g<=i.max:i.min||0==i.min?d=s>=i.min:i.max&&(d=g<=i.max),d||o.push(i.key),i.type==l.Interval&&s>g&&o.push(i.key)}if(i.type==l.Json)try{JSON.parse(a)}catch(s){o.push(i.key)}}return o})(this.settings),0===this.invalidMembers.length?this.store.dispatch(new S.N(this.settings)).subscribe(()=>{this.notificationService.showSuccess("SETTINGS_SAVE")}):(this.changeLabelColor("red"),this.notificationService.showError("SETTINGS_SAVE"))}changeLabelColor(o){this.invalidMembers.forEach(e=>{Array.from(document.getElementsByClassName(e)).forEach(a=>{a.style.color=o})})}onReset(){this.changeLabelColor("grey"),this.settings=this.deepCopy(this.oldSettings)}onColorChange(o){this.settings[o]=document.getElementById(o).value}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}m.\u0275fac=function(o){return new(o||m)(t.Y36(f.yh),t.Y36(b.g),t.Y36(A.K))},m.\u0275cmp=t.Xpm({type:m,selectors:[["taskana-administration-settings"]],decls:12,vars:1,consts:[[1,"settings"],[1,"settings__buttons"],["mat-button","","matTooltip","Save settings",1,"settings__button--primary",3,"click"],[1,"md-20"],["mat-stroked-button","","matTooltip","Revert changes",1,"settings__button--secondary",3,"click"],[1,"settings__icon","md-20"],[1,"settings__content"],[4,"ngFor","ngForOf"],[1,"settings__domain-name"],[1,"settings__spacer"],["class","settings__grid",4,"ngIf"],["class","settings__grid settings__color",4,"ngIf"],[1,"settings__grid"],[1,"settings__text"],["appearance","outline",1,"settings__grid--two-columns"],["matInput","","type","text",3,"ngModel","maxlength","minlength","placeholder","ngModelChange"],["appearance","outline"],["matInput","","placeholder","Lower boundary","type","number",3,"ngModel","max","min","ngModelChange"],["matInput","","placeholder","Upper boundary","type","number",3,"ngModel","max","min","ngModelChange"],[1,"settings__grid","settings__color"],["matInput","","type","color",1,"settings__colors--input",3,"id","value","change"],["cdkAutosizeMaxRows","10","cdkAutosizeMinRows","1","cdkTextareaAutosize","","matInput","",3,"ngModel","placeholder","ngModelChange"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("click",function(){return e.onSave()}),t._uU(3," Save "),t.TgZ(4,"mat-icon",3),t._uU(5,"save"),t.qZA()(),t.TgZ(6,"button",4),t.NdJ("click",function(){return e.onReset()}),t._uU(7," Undo changes "),t.TgZ(8,"mat-icon",5),t._uU(9,"restore"),t.qZA()()(),t.TgZ(10,"div",6),t.YNc(11,E,5,2,"div",7),t.qZA()()),2&o&&(t.xp6(11),t.Q6J("ngForOf",e.settings.schema))},directives:[v.lW,h.gM,x.Hw,p.sg,p.O5,y.KE,y.hX,C.Nt,c.Fj,c.JJ,c.On,c.nD,c.wO,c.wV,c.Fd,c.qQ,J.IC],styles:[".settings[_ngcontent-%COMP%]{padding:8px 32px;overflow-y:scroll}.settings__content[_ngcontent-%COMP%]{height:calc(100vh - 116px);padding:4px}.settings__domain-name[_ngcontent-%COMP%]{margin-bottom:20px}.settings__buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-bottom:8px}.settings__button--primary[_ngcontent-%COMP%]{background-color:#22a39f;color:#fff;margin:4px}.settings__button--secondary[_ngcontent-%COMP%]{background-color:#fff;margin:4px}.settings__spacer[_ngcontent-%COMP%]{height:24px}.settings__grid[_ngcontent-%COMP%]{display:grid;grid-gap:4px;grid-template-columns:300px 1fr 1fr}.settings__text[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:18px}.settings__grid--center[_ngcontent-%COMP%]{align-self:center}.settings__grid--two-columns[_ngcontent-%COMP%]{grid-column:2/4}.settings__color[_ngcontent-%COMP%]{margin-bottom:16px}.settings__colors--input[_ngcontent-%COMP%]{width:100px}.settings__icon[_ngcontent-%COMP%]{color:#22a39f}  .ng-invalid.ng-touched:not(form){box-shadow:unset}"]}),function(n,o,e,i){var g,a=arguments.length,s=a<3?o:null===i?i=Object.getOwnPropertyDescriptor(o,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,o,e,i);else for(var d=n.length-1;d>=0;d--)(g=n[d])&&(s=(a<3?g(s):a>3?g(o,e,s):g(o,e))||s);a>3&&s&&Object.defineProperty(o,e,s)}([(0,f.Ph)(Z.u.getSettings),function(n,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata("design:type",o)}(0,T.y)],m.prototype,"settings$",void 0);const j=[{path:"",component:m}];let F=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[u.Bz.forChild(j)],u.Bz]}),n})();var Q=r(685);let Y=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[Q.g],imports:[[p.ez,F,x.Ps,h.AV,v.ot,C.c,c.u5]]}),n})()}}]);
//# sourceMappingURL=src_app_settings_settings_module_ts.f3f2704db4da51fb.js.map